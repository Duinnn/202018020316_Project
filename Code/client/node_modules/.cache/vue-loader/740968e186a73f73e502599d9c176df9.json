{"remainingRequest":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\src\\components\\AccountsManage\\AccountsManage.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\src\\components\\AccountsManage\\AccountsManage.vue","mtime":1713991491714},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\css-loader\\dist\\cjs.js","mtime":1709809064163},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1709809064695},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\postcss-loader\\src\\index.js","mtime":1709809064578},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709809049101},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":1709809064695}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKLmFjY291bnRzLW1hbmFnZS10b3AtbGluZSB7CiAgZGlzcGxheTogZmxleDsKICBwYWRkaW5nOiAwIDAgMjBweCAwOwp9Ci5zZWFyY2gtbmFtZSB7CiAgZm9udC1zaXplOiAxNHB4OwogIHdpZHRoOiA5MHB4Owp9Ci5hY2NvdW50cy1tYW5hZ2UtdG9wLWl0ZW0gewogIGRpc3BsYXk6IGZsZXg7CiAgYWxpZ24taXRlbXM6IGNlbnRlcjsKICBtYXJnaW4tcmlnaHQ6IDIwcHg7Cn0KLmFjY291bnRzLW1hbmFnZS10b3AtaXRlbTpudGgtbGFzdC1jaGlsZCgxKSB7CiAgbWFyZ2luLXJpZ2h0OiAwOwp9Ci5hY2NvdW50cy1tYW5hZ2UtdG9wLWl0ZW0gc3BhbiB7CiAgbWFyZ2luLXJpZ2h0OiAxMHB4Owp9Ci5lbC10YWJsZSAud2FybmluZy1yb3cgewogIGJhY2tncm91bmQ6IG9sZGxhY2U7Cn0KCi5lbC10YWJsZSAuc3VjY2Vzcy1yb3cgewogIGJhY2tncm91bmQ6ICNmMGY5ZWI7Cn0KLmFjY291bnRzLW1hbmFnZS10YWJsZSB7CiAgYm9yZGVyOiAxcHggc29saWQgI2ViZWJlYjsKfQouZGF0ZSB7Cn0K"},{"version":3,"sources":["AccountsManage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyhBA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"AccountsManage.vue","sourceRoot":"src/components/AccountsManage","sourcesContent":["<template>\n  <div class=\"accounts-manage\">\n    <div class=\"accounts-manage-top\">\n      <div class=\"accounts-manage-top-line\">\n        <div class=\"accounts-manage-top-item\">\n          <span class=\"search-name\">Keywords</span>\n          <el-input\n            style=\"width: 290px; margin-right: 20px\"\n            placeholder=\"Please Enter The Content\"\n            v-model=\"keyWords\"\n            @keyup.enter.native=\"searchList\"\n          >\n            <el-button\n              @click=\"searchList\"\n              slot=\"append\"\n              icon=\"el-icon-search\"\n            ></el-button>\n          </el-input>\n        </div>\n        <div class=\"accounts-manage-top-item\">\n          <span class=\"search-name\">Bill Type</span>\n          <el-select\n            style=\"width: 250px; margin-right: 20px\"\n            v-model=\"params.billType\"\n            placeholder=\"Please Select\"\n            @change=\"changeBillType\"\n          >\n            <el-option\n              v-for=\"item in billTypeOptions\"\n              :key=\"item.value\"\n              :label=\"item.label\"\n              :value=\"item.value\"\n            >\n            </el-option>\n          </el-select>\n        </div>\n        <div class=\"accounts-manage-top-item\">\n          <el-date-picker\n            v-model=\"date\"\n            class=\"date\"\n            type=\"datetimerange\"\n            range-separator=\"To\"\n            start-placeholder=\"Start Date\"\n            end-placeholder=\"End Date\"\n            @change=\"changeDate\"\n            value-format=\"yyyy-MM-dd HH:mm:ss\"\n          >\n          </el-date-picker>\n        </div>\n      </div>\n      <div class=\"accounts-manage-top-line\">\n        <div class=\"accounts-manage-top-item\">\n          <span class=\"search-name\">Family Members</span>\n          <el-select\n            style=\"width: 290px; margin-right: 20px\"\n            v-model=\"params.userId\"\n            placeholder=\"Please Select\"\n            @change=\"changeUserId\"\n          >\n            <el-option\n              v-for=\"item in userList\"\n              :key=\"item.id\"\n              :label=\"item.name\"\n              :value=\"item.id\"\n            >\n            </el-option>\n          </el-select>\n        </div>\n        <div\n          class=\"accounts-manage-top-item\"\n          :style=\"this.params.billType === '1' ? 'display: none' : ''\"\n        >\n          <span class=\"search-name\">Consumption Type</span>\n          <el-select\n            style=\"width: 250px; margin-right: 20px\"\n            v-model=\"params.consumptionId\"\n            placeholder=\"Please Select\"\n            @change=\"changeConsumptionId\"\n          >\n            <el-option\n              v-for=\"item in allConsumeList\"\n              :key=\"item.id\"\n              :label=\"item.name\"\n              :value=\"item.id\"\n            >\n            </el-option>\n          </el-select>\n        </div>\n\n        <el-button\n          type=\"primary\"\n          @click=\"\n            accountModalVisible = true\n            modalTitle = 'Add Bill'\n          \"\n          >Add Bill</el-button\n        >\n      </div>\n\n      <el-dialog\n        :title=\"modalTitle\"\n        :visible.sync=\"accountModalVisible\"\n        destroy-on-close\n        @close=\"\n          accountModalVisible = false\n          form = {\n            billType: '1',\n            consumptionId: '',\n            recordTime: '',\n            money: '',\n            remark: '',\n          }\n        \"\n      >\n        <el-form :model=\"form\" :rules=\"rules\" ref=\"form\">\n          <el-form-item\n            label=\"Bill Type\"\n            :label-width=\"formLabelWidth\"\n            prop=\"billType\"\n          >\n            <el-radio v-model=\"form.billType\" label=\"1\">Expense</el-radio>\n            <el-radio v-model=\"form.billType\" label=\"2\">Income</el-radio>\n          </el-form-item>\n          <el-form-item\n            :style=\"form.billType === '2' ? 'display: none' : ''\"\n            label=\"Consumption Type\"\n            :label-width=\"formLabelWidth\"\n            prop=\"consumptionId\"\n          >\n            <el-select\n              style=\"width: 300px\"\n              v-model=\"form.consumptionId\"\n              placeholder=\"Please Select\"\n            >\n              <el-option\n                v-for=\"item in consumeList\"\n                :key=\"item.id\"\n                :label=\"item.name\"\n                :value=\"item.id\"\n              >\n              </el-option>\n            </el-select>\n          </el-form-item>\n          <el-form-item label=\"Money\" :label-width=\"formLabelWidth\" prop=\"money\">\n            <el-input\n              style=\"width: 300px\"\n              v-model=\"form.money\"\n              autocomplete=\"off\"\n            ></el-input>\n          </el-form-item>\n          <el-form-item\n            label=\"Date\"\n            :label-width=\"formLabelWidth\"\n            prop=\"recordTime\"\n          >\n            <el-date-picker\n              v-model=\"form.recordTime\"\n              type=\"datetime\"\n              placeholder=\"Select Date\"\n              style=\"width: 300px\"\n              :picker-消费类型=\"pickerOptions\"\n            >\n            </el-date-picker>\n          </el-form-item>\n          <el-form-item\n            label=\"Notes\"\n            :label-width=\"formLabelWidth\"\n            prop=\"remark\"\n          >\n            <el-input\n              type=\"textarea\"\n              style=\"width: 300px\"\n              v-model=\"form.remark\"\n              autocomplete=\"off\"\n            ></el-input>\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button\n            @click=\"\n              accountModalVisible = false\n              form = {\n                billType: '1',\n                consumptionId: '',\n                recordTime: new Date().toUTCString(),\n                money: '',\n                remark: '',\n              }\n            \"\n            >Cancel</el-button\n          >\n          <el-button type=\"primary\" @click=\"addAccount('form')\"\n            >Confirm</el-button\n          >\n        </div>\n      </el-dialog>\n    </div>\n    <div style=\"height: calc(100% - 80px)\" v-loading=\"loading\">\n      <el-table\n        class=\"accounts-manage-table\"\n        :data=\"tableData\"\n        style=\"width: 100%\"\n        :row-class-name=\"tableRowClassName\"\n      >\n        <el-table-column prop=\"index\" label=\"Order Number\" width=\"160\" type=\"index\">\n        </el-table-column>\n        <el-table-column prop=\"userName\" label=\"Bookkeeper\" width=\"160\"> </el-table-column>\n\n        <el-table-column label=\"Bill Type\">\n          <template slot-scope=\"scope\">\n            {{ scope.row.billType === 2 ? 'Income' : 'Expense' }}\n          </template>\n        </el-table-column>\n        <el-table-column prop=\"consumptionName\" label=\"Consumption Type\">\n        </el-table-column>\n        <el-table-column prop=\"money\" label=\"Money\"> </el-table-column>\n        <el-table-column\n          prop=\"recordTime\"\n          :formatter=\"formatterTime\"\n          label=\"Creation Time\"\n        >\n        </el-table-column>\n        <el-table-column prop=\"remark\" label=\"Notes\"> </el-table-column>\n        <el-table-column label=\"Operation\" width=\"100\">\n          <template slot-scope=\"scope\">\n            <el-button\n              @click=\"editAccount(scope.row)\"\n              type=\"text\"\n              size=\"small\"\n              style=\"margin-right: 20px\"\n              >Edit</el-button\n            >\n            <el-popconfirm\n              :title=\"`Are you sure to remove this bill?`\"\n              @confirm=\"deleteRow(scope.row)\"\n            >\n              <el-button type=\"text\" size=\"small\" slot=\"reference\"\n                >Delete</el-button\n              >\n            </el-popconfirm>\n          </template>\n        </el-table-column>\n      </el-table>\n      <div style=\"text-align: right; padding: 10px 0 10px 10px\">\n        <el-pagination\n          style=\"padding: 0\"\n          background\n          layout=\"prev, pager, next\"\n          :current-page=\"pageNum\"\n          :total=\"total\"\n          :page-size=\"pageSize\"\n          @current-change=\"handleCurrentChange\"\n        >\n        </el-pagination>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { get, post, put } from '../../utils/http'\nimport moment from 'moment'\nimport { Message } from 'element-ui'\n\nexport default {\n  name: 'AccountsManage',\n  data() {\n    let validateMoney = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('Please enter the amount'))\n      } else {\n        let reg = /^(([1-9][0-9]*)|(([0]\\.\\d{1,2}|[1-9][0-9]*\\.\\d{1,2})))$/\n        if (!reg.test(value)) {\n          callback(new Error('Amount is an integer or up to two decimal places'))\n        }\n\n        callback()\n      }\n    }\n    return {\n      accountModalVisible: false,\n      tableData: [],\n      billTypeOptions: [\n        {\n          value: '000000',\n          label: 'Total',\n        },\n        {\n          value: '2',\n          label: 'Income',\n        },\n        {\n          value: '1',\n          label: 'Expense',\n        },\n      ],\n      form: {\n        billType: '1',\n        consumptionId: '',\n        recordTime: new Date().toUTCString(),\n        money: '',\n        remark: '',\n      },\n      rules: {\n        billType: [\n          { required: true, message: 'Consumption type cannot be empty', trigger: 'change' },\n        ],\n        money: [\n          { required: true, message: 'The amount cannot be empty' },\n          { validator: validateMoney, trigger: 'change' },\n        ],\n        consumptionId: [\n          {\n            required: this.billType === '1' ? true : false,\n            message: 'Consumption type cannot be empty',\n          },\n        ],\n        recordTime: [{ required: true, message: 'The date cannot be empty' }],\n      },\n      loading: false,\n      formLabelWidth: '160px',\n      keyWords: '',\n      allConsumeList: [],\n      consumeList: [],\n      pageNum: 1,\n      pageSize: 10,\n      total: 0,\n      params: {\n        houseId: sessionStorage.getItem('houseId'),\n        userId: '000000',\n        consumptionId: '000000',\n        billType: '000000',\n        onlySelf: false,\n      },\n      date: [],\n      modalTitle: 'Add Bill',\n      selectId: '',\n      userList: [],\n      pickerOptions: {\n        disabledDate(time) {\n          return time.getTime() > Date.now()\n        },\n      },\n    }\n  },\n  mounted() {\n    this.getList()\n    this.getUser()\n    this.getConsumeList()\n  },\n  methods: {\n    formatterTime(row, column, cellValue) {\n      return moment(cellValue).format('YYYY-MM-DD HH:mm:ss')\n    },\n    getConsumeList() {\n      get('/consumptionType/query', {\n        houseId: this.params.houseId,\n      }).then((res) => {\n        this.loading = false\n        if (res.description === 'success') {\n          this.consumeList = JSON.parse(JSON.stringify(res.data))\n          this.allConsumeList = JSON.parse(JSON.stringify(res.data))\n          this.allConsumeList.unshift({\n            id: '000000',\n            name: 'Total',\n          })\n        }\n      })\n    },\n    tableRowClassName({ rowIndex }) {\n      if (rowIndex === 1) {\n        return 'warning-row'\n      } else if (rowIndex === 3) {\n        return 'success-row'\n      }\n      return ''\n    },\n    addAccount(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          let params = {\n            userId: sessionStorage.getItem('userId'),\n            houseId: sessionStorage.getItem('houseId'),\n            consumptionId: this.form.consumptionId,\n            billType: this.form.billType,\n            money: this.form.money,\n            remark: this.form.remark,\n            recordTime: moment(this.form.recordTime).format(\n              'YYYY-MM-DD HH:mm:ss'\n            ),\n          }\n          if (this.form.billType === '2') {\n            params.consumptionId = 0\n          }\n          if (this.modalTitle === 'Edit Bill') {\n            params.id = this.selectId\n            put('/bill/update', params).then((res) => {\n              if (res.description === 'success') {\n                Message.success({ message: 'Successfully edited bill' })\n                this.accountModalVisible = false\n                this.pageNum = 1\n                this.getList()\n                this.form = {\n                  billType: '1',\n                  consumptionId: '',\n                  recordTime: '',\n                  money: '',\n                  remark: '',\n                }\n              }\n            })\n          } else {\n            post('/bill/add', params).then((res) => {\n              if (res.description === 'success') {\n                Message.success({ message: 'Successfully added bill' })\n                this.accountModalVisible = false\n                this.pageNum = 1\n                this.getList()\n              }\n            })\n          }\n        } else {\n          return false\n        }\n      })\n    },\n    getList() {\n      this.loading = true\n      let { userId, consumptionId, billType } = this.params\n      if (userId === '000000') {\n        userId = sessionStorage.getItem('userId')\n      }\n      if (consumptionId === '000000') {\n        consumptionId = ''\n      }\n      if (billType === '000000') {\n        billType = ''\n      }\n      get('/bill/query', {\n        ...this.params,\n        userId: userId,\n        consumptionId,\n        billType,\n        pageNum: this.pageNum,\n        pageSize: this.pageSize,\n        remark: this.keyWords,\n      }).then((res) => {\n        this.loading = false\n        if (res.description === 'success') {\n          this.tableData = res.data.list\n          this.total = res.data.total\n        }\n      })\n    },\n    handleCurrentChange(val) {\n      this.pageNum = val\n      this.getList()\n    },\n    changeBillType(type) {\n      this.pageNum = 1\n      if (type !== '0') {\n        this.params.billType = type\n      } else {\n        delete this.params.billType\n      }\n      this.getList()\n    },\n    changeConsumptionId(id) {\n      this.pageNum = 1\n      if (id !== '0') {\n        this.params.consumptionId = id\n      } else {\n        delete this.params.consumptionId\n      }\n      this.getList()\n    },\n    changeDate(date) {\n      this.pageNum = 1\n      if (date !== null) {\n        this.params.beginDate = date[0]\n        this.params.endDate = date[1]\n      } else {\n        delete this.params.beginDate\n        delete this.params.endDate\n      }\n      this.getList()\n    },\n    changeUserId(userId) {\n      this.pageNum = 1\n      this.params.onlySelf = false\n      if (userId === Number(sessionStorage.getItem('userId'))) {\n        this.params.onlySelf = true\n      }\n      this.params.userId = userId\n      this.getList()\n    },\n    editAccount(row) {\n      this.modalTitle = 'Edit Bill'\n      this.accountModalVisible = true\n      this.form.billType = row.billType + ''\n      this.form.consumptionId = row.consumptionId\n      this.form.money = row.money\n      this.form.recordTime = row.recordTime\n      this.form.remark = row.remark\n      this.selectId = row.id\n    },\n    deleteRow(row) {\n      put('/bill/remove', { id: row.id }).then((res) => {\n        if (res.description === 'success') {\n          Message.success({ message: 'Successfully deleted bill' })\n          this.pageNum = 1\n          this.getList()\n        }\n      })\n    },\n    searchList() {\n      this.pageNum = 1\n      this.getList()\n    },\n    getUser() {\n      get('/user/query', {\n        houseId: sessionStorage.getItem('houseId'),\n      }).then((res) => {\n        if (res.description === 'success') {\n          this.userList = res.data.list\n          this.userList.unshift({\n            id: '000000',\n            name: 'Total',\n          })\n        }\n      })\n    },\n  },\n}\n</script>\n\n<style>\n.accounts-manage-top-line {\n  display: flex;\n  padding: 0 0 20px 0;\n}\n.search-name {\n  font-size: 14px;\n  width: 90px;\n}\n.accounts-manage-top-item {\n  display: flex;\n  align-items: center;\n  margin-right: 20px;\n}\n.accounts-manage-top-item:nth-last-child(1) {\n  margin-right: 0;\n}\n.accounts-manage-top-item span {\n  margin-right: 10px;\n}\n.el-table .warning-row {\n  background: oldlace;\n}\n\n.el-table .success-row {\n  background: #f0f9eb;\n}\n.accounts-manage-table {\n  border: 1px solid #ebebeb;\n}\n.date {\n}\n</style>\n"]}]}