{"remainingRequest":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\src\\components\\UserManage\\UserManage.vue?vue&type=style&index=0&lang=css&","dependencies":[{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\src\\components\\UserManage\\UserManage.vue","mtime":1713991226823},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\css-loader\\dist\\cjs.js","mtime":1709809064163},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\vue-loader\\lib\\loaders\\stylePostLoader.js","mtime":1709809064695},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\postcss-loader\\src\\index.js","mtime":1709809064578},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709809049101},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":1709809064695}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:CgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoKCgoudXNlci1tYW5hZ2UtdG9wIHsKICBkaXNwbGF5OiBmbGV4OwogIGp1c3RpZnktY29udGVudDogZmxleC1lbmQ7CiAgcGFkZGluZy1ib3R0b206IDE1cHg7Cn0KLmVsLXRhYmxlIC53YXJuaW5nLXJvdyB7CiAgYmFja2dyb3VuZDogb2xkbGFjZTsKfQoKLmVsLXRhYmxlIC5zdWNjZXNzLXJvdyB7CiAgYmFja2dyb3VuZDogI2YwZjllYjsKfQoudXNlci1tYW5hZ2UtdGFibGUgewogIGJvcmRlcjogMXB4IHNvbGlkICNlYmViZWI7Cn0K"},{"version":3,"sources":["UserManage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8PA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA","file":"UserManage.vue","sourceRoot":"src/components/UserManage","sourcesContent":["<template>\n  <div class=\"user-manage\" style=\"height: 100%\">\n    <div class=\"user-manage-top\">\n      <!-- <el-input style=\"width: 200px; margin-right: 20px\"\n                placeholder=\"Please Enter The Content\"\n                v-model=\"input2\">\n        <el-button slot=\"append\"\n                   icon=\"el-icon-search\"></el-button>\n      </el-input> -->\n      <el-button type=\"primary\" @click=\"dialogFormVisible = true\"\n        >Add User</el-button\n      >\n      <el-dialog\n        title=\"Add family member\"\n        :visible.sync=\"dialogFormVisible\"\n        destroy-on-close\n      >\n        <el-form :model=\"form\" :rules=\"rules\" ref=\"form\">\n          <el-form-item label=\"Account Number\" :label-width=\"formLabelWidth\" prop=\"name\">\n            <el-input v-model=\"form.name\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item\n            label=\"Password\"\n            :label-width=\"formLabelWidth\"\n            prop=\"password\"\n          >\n            <el-input v-model=\"form.password\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"dialogFormVisible = false\">Cancel</el-button>\n          <el-button type=\"primary\" @click=\"addUser('form')\">Confirm</el-button>\n        </div>\n      </el-dialog>\n      <el-dialog :visible.sync=\"passwordModalVisible\" destroy-on-close>\n        <div style=\"text-align: center\">{{ resetPassword }}</div>\n      </el-dialog>\n    </div>\n    <div style=\"height: calc(100% - 80px)\" v-loading=\"loading\">\n      <!-- <div slot=\"empty\" style=\"height: 100%; display: flex; justify-content: center; align-items: center\">There is currently no data available</div> -->\n\n      <el-table\n        class=\"user-manage-table\"\n        :data=\"tableData\"\n        style=\"width: 100%\"\n        :row-class-name=\"tableRowClassName\"\n      >\n        <el-table-column prop=\"index\" label=\"Order Number\" type=\"index\" width=\"180\">\n        </el-table-column>\n        <el-table-column prop=\"name\" label=\"Name\" width=\"180\">\n        </el-table-column>\n        <el-table-column\n          prop=\"createTime\"\n          :formatter=\"formatterTime\"\n          label=\"Creation Time\"\n        >\n        </el-table-column>\n        <el-table-column label=\"Operation\" width=\"200\">\n          <template slot-scope=\"scope\">\n            <el-popconfirm\n              :title=\"`Are you sure to move${scope.row.name}out of this family?`\"\n              @confirm=\"deleteRow(scope.row)\"\n            >\n              <el-button type=\"text\" size=\"small\" slot=\"reference\"\n                >Delete</el-button\n              >\n            </el-popconfirm>\n            <el-popconfirm\n              :title=\"`Are you sure you want to reset the password for${scope.row.name}?`\"\n              @confirm=\"resetPassWord(scope.row)\"\n            >\n              <el-button\n                type=\"text\"\n                size=\"small\"\n                slot=\"reference\"\n                style=\"margin: 0 10px\"\n                >Reset Password</el-button\n              >\n            </el-popconfirm>\n            <el-popconfirm\n              :title=\"`Are you sure you want to transfer the administrator to${scope.row.name}?`\"\n              @confirm=\"transferAdmin(scope.row)\"\n            >\n              <el-button type=\"text\" size=\"small\" slot=\"reference\"\n                >Transfer Administrator</el-button\n              >\n            </el-popconfirm>\n          </template>\n        </el-table-column>\n      </el-table>\n      <div style=\"text-align: right; padding: 10px 0 10px 10px\">\n        <el-pagination\n          style=\"padding: 0\"\n          background\n          layout=\"prev, pager, next\"\n          :current-page=\"pageNum\"\n          :total=\"total\"\n          :page-size=\"pageSize\"\n          @current-change=\"handleCurrentChange\"\n        >\n        </el-pagination>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { get, post, put } from '../../utils/http'\nimport moment from 'moment'\nimport { Message } from 'element-ui'\nexport default {\n  name: 'UserManage',\n  mounted() {\n    this.getList()\n  },\n  data() {\n    let validateName = (rule, value, callback) => {\n      console.log(value)\n      if (value === '') {\n        callback(new Error('Please enter your account number'))\n      } else {\n        let reg = /^[a-zA-Z0-9_-]{2,16}$/\n        if (!reg.test(value)) {\n          callback(new Error('The username must consist of 2-16 characters, letters, numbers, and underscores!'))\n        }\n\n        callback()\n      }\n    }\n    let validatePassword = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('Please enter password'))\n      } else {\n        let reg = /^[a-zA-Z0-9]{8}$/\n        if (!reg.test(value)) {\n          callback(new Error('The password must consist of 8 letters and numbers, and cannot contain illegal characters!'))\n        }\n\n        callback()\n      }\n    }\n    return {\n      tableData: [],\n      loading: false,\n      dialogFormVisible: false,\n      passwordModalVisible: false,\n      form: {\n        name: '',\n        password: '',\n      },\n      formLabelWidth: '160px',\n      pageNum: 1,\n      pageSize: 10,\n      total: 0,\n      resetPassword: '',\n      rules: {\n        name: [\n          { required: true, message: 'Account cannot be empty', trigger: 'change' },\n          { validator: validateName, trigger: 'change' },\n        ],\n        password: [\n          { required: true, message: 'Password cannot be empty' },\n          { validator: validatePassword, trigger: 'change' },\n        ],\n      },\n    }\n  },\n  methods: {\n    formatterTime(row, column, cellValue) {\n      return moment(cellValue).format('YYYY-MM-DD HH:mm:ss')\n    },\n    tableRowClassName({ rowIndex }) {\n      if (rowIndex === 1) {\n        return 'warning-row'\n      } else if (rowIndex === 3) {\n        return 'success-row'\n      }\n      return ''\n    },\n    handleCurrentChange(val) {\n      this.pageNum = val\n      this.getList()\n    },\n    getList() {\n      this.loading = true\n      get('/user/query', {\n        houseId: sessionStorage.getItem('houseId'),\n        pageNum: this.pageNum,\n        pageSize: this.pageSize,\n      }).then((res) => {\n        this.loading = false\n        if (res.description === 'success') {\n          this.tableData = res.data.list.filter((item) => item.isAdmin !== 1)\n          this.total = res.data.total\n        }\n      })\n    },\n    addUser(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          post('/user/add', {\n            houseId: sessionStorage.getItem('houseId'),\n            name: this.form.name,\n            password: this.form.password,\n            isAdmin: 0,\n          }).then((res) => {\n            this.dialogFormVisible = false\n            if (res.description === 'success') {\n              this.pageNum = 1\n              this.getList()\n            }\n          })\n        } else {\n          return false\n        }\n      })\n    },\n    deleteRow(row) {\n      put('/user/remove', {\n        adminUserId: sessionStorage.getItem('userId'),\n        removeUserId: row.id,\n      }).then((res) => {\n        if (res.description === 'success') {\n          Message.success({ message: 'Successfully Remove!' })\n          this.pageNum = 1\n          this.getList()\n        }\n      })\n    },\n    resetPassWord(row) {\n      put('/user/resetPwd', { id: row.id }).then((res) => {\n        if (res.description === 'success') {\n          this.resetPassword = `${row.name} Password has been reset to: ${res.data.password}`\n          this.passwordModalVisible = true\n        }\n      })\n    },\n    transferAdmin(row) {\n      put('/user/transferAdmin', {\n        fromUserId: sessionStorage.getItem('userId'),\n        toUserId: row.id,\n      }).then((res) => {\n        if (res.description === 'success') {\n          Message.success({ message: 'Successfully Transfer' })\n          this.pageNum = 1\n          this.getList()\n        }\n      })\n    },\n  },\n}\n</script>\n\n<style>\n.user-manage-top {\n  display: flex;\n  justify-content: flex-end;\n  padding-bottom: 15px;\n}\n.el-table .warning-row {\n  background: oldlace;\n}\n\n.el-table .success-row {\n  background: #f0f9eb;\n}\n.user-manage-table {\n  border: 1px solid #ebebeb;\n}\n</style>\n"]}]}