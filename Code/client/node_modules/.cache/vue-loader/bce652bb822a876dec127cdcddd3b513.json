{"remainingRequest":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\src\\components\\UserManage\\UserManage.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\src\\components\\UserManage\\UserManage.vue","mtime":1713991226823},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709809049101},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1709809049077},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709809049101},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":1709809064695}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldCwgcG9zdCwgcHV0IH0gZnJvbSAnLi4vLi4vdXRpbHMvaHR0cCcKaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnCmltcG9ydCB7IE1lc3NhZ2UgfSBmcm9tICdlbGVtZW50LXVpJwpleHBvcnQgZGVmYXVsdCB7CiAgbmFtZTogJ1VzZXJNYW5hZ2UnLAogIG1vdW50ZWQoKSB7CiAgICB0aGlzLmdldExpc3QoKQogIH0sCiAgZGF0YSgpIHsKICAgIGxldCB2YWxpZGF0ZU5hbWUgPSAocnVsZSwgdmFsdWUsIGNhbGxiYWNrKSA9PiB7CiAgICAgIGNvbnNvbGUubG9nKHZhbHVlKQogICAgICBpZiAodmFsdWUgPT09ICcnKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCdQbGVhc2UgZW50ZXIgeW91ciBhY2NvdW50IG51bWJlcicpKQogICAgICB9IGVsc2UgewogICAgICAgIGxldCByZWcgPSAvXlthLXpBLVowLTlfLV17MiwxNn0kLwogICAgICAgIGlmICghcmVnLnRlc3QodmFsdWUpKSB7CiAgICAgICAgICBjYWxsYmFjayhuZXcgRXJyb3IoJ1RoZSB1c2VybmFtZSBtdXN0IGNvbnNpc3Qgb2YgMi0xNiBjaGFyYWN0ZXJzLCBsZXR0ZXJzLCBudW1iZXJzLCBhbmQgdW5kZXJzY29yZXMhJykpCiAgICAgICAgfQoKICAgICAgICBjYWxsYmFjaygpCiAgICAgIH0KICAgIH0KICAgIGxldCB2YWxpZGF0ZVBhc3N3b3JkID0gKHJ1bGUsIHZhbHVlLCBjYWxsYmFjaykgPT4gewogICAgICBpZiAodmFsdWUgPT09ICcnKSB7CiAgICAgICAgY2FsbGJhY2sobmV3IEVycm9yKCdQbGVhc2UgZW50ZXIgcGFzc3dvcmQnKSkKICAgICAgfSBlbHNlIHsKICAgICAgICBsZXQgcmVnID0gL15bYS16QS1aMC05XXs4fSQvCiAgICAgICAgaWYgKCFyZWcudGVzdCh2YWx1ZSkpIHsKICAgICAgICAgIGNhbGxiYWNrKG5ldyBFcnJvcignVGhlIHBhc3N3b3JkIG11c3QgY29uc2lzdCBvZiA4IGxldHRlcnMgYW5kIG51bWJlcnMsIGFuZCBjYW5ub3QgY29udGFpbiBpbGxlZ2FsIGNoYXJhY3RlcnMhJykpCiAgICAgICAgfQoKICAgICAgICBjYWxsYmFjaygpCiAgICAgIH0KICAgIH0KICAgIHJldHVybiB7CiAgICAgIHRhYmxlRGF0YTogW10sCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBkaWFsb2dGb3JtVmlzaWJsZTogZmFsc2UsCiAgICAgIHBhc3N3b3JkTW9kYWxWaXNpYmxlOiBmYWxzZSwKICAgICAgZm9ybTogewogICAgICAgIG5hbWU6ICcnLAogICAgICAgIHBhc3N3b3JkOiAnJywKICAgICAgfSwKICAgICAgZm9ybUxhYmVsV2lkdGg6ICcxNjBweCcsCiAgICAgIHBhZ2VOdW06IDEsCiAgICAgIHBhZ2VTaXplOiAxMCwKICAgICAgdG90YWw6IDAsCiAgICAgIHJlc2V0UGFzc3dvcmQ6ICcnLAogICAgICBydWxlczogewogICAgICAgIG5hbWU6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICdBY2NvdW50IGNhbm5vdCBiZSBlbXB0eScsIHRyaWdnZXI6ICdjaGFuZ2UnIH0sCiAgICAgICAgICB7IHZhbGlkYXRvcjogdmFsaWRhdGVOYW1lLCB0cmlnZ2VyOiAnY2hhbmdlJyB9LAogICAgICAgIF0sCiAgICAgICAgcGFzc3dvcmQ6IFsKICAgICAgICAgIHsgcmVxdWlyZWQ6IHRydWUsIG1lc3NhZ2U6ICdQYXNzd29yZCBjYW5ub3QgYmUgZW1wdHknIH0sCiAgICAgICAgICB7IHZhbGlkYXRvcjogdmFsaWRhdGVQYXNzd29yZCwgdHJpZ2dlcjogJ2NoYW5nZScgfSwKICAgICAgICBdLAogICAgICB9LAogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgZm9ybWF0dGVyVGltZShyb3csIGNvbHVtbiwgY2VsbFZhbHVlKSB7CiAgICAgIHJldHVybiBtb21lbnQoY2VsbFZhbHVlKS5mb3JtYXQoJ1lZWVktTU0tREQgSEg6bW06c3MnKQogICAgfSwKICAgIHRhYmxlUm93Q2xhc3NOYW1lKHsgcm93SW5kZXggfSkgewogICAgICBpZiAocm93SW5kZXggPT09IDEpIHsKICAgICAgICByZXR1cm4gJ3dhcm5pbmctcm93JwogICAgICB9IGVsc2UgaWYgKHJvd0luZGV4ID09PSAzKSB7CiAgICAgICAgcmV0dXJuICdzdWNjZXNzLXJvdycKICAgICAgfQogICAgICByZXR1cm4gJycKICAgIH0sCiAgICBoYW5kbGVDdXJyZW50Q2hhbmdlKHZhbCkgewogICAgICB0aGlzLnBhZ2VOdW0gPSB2YWwKICAgICAgdGhpcy5nZXRMaXN0KCkKICAgIH0sCiAgICBnZXRMaXN0KCkgewogICAgICB0aGlzLmxvYWRpbmcgPSB0cnVlCiAgICAgIGdldCgnL3VzZXIvcXVlcnknLCB7CiAgICAgICAgaG91c2VJZDogc2Vzc2lvblN0b3JhZ2UuZ2V0SXRlbSgnaG91c2VJZCcpLAogICAgICAgIHBhZ2VOdW06IHRoaXMucGFnZU51bSwKICAgICAgICBwYWdlU2l6ZTogdGhpcy5wYWdlU2l6ZSwKICAgICAgfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgdGhpcy5sb2FkaW5nID0gZmFsc2UKICAgICAgICBpZiAocmVzLmRlc2NyaXB0aW9uID09PSAnc3VjY2VzcycpIHsKICAgICAgICAgIHRoaXMudGFibGVEYXRhID0gcmVzLmRhdGEubGlzdC5maWx0ZXIoKGl0ZW0pID0+IGl0ZW0uaXNBZG1pbiAhPT0gMSkKICAgICAgICAgIHRoaXMudG90YWwgPSByZXMuZGF0YS50b3RhbAogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBhZGRVc2VyKGZvcm1OYW1lKSB7CiAgICAgIHRoaXMuJHJlZnNbZm9ybU5hbWVdLnZhbGlkYXRlKCh2YWxpZCkgPT4gewogICAgICAgIGlmICh2YWxpZCkgewogICAgICAgICAgcG9zdCgnL3VzZXIvYWRkJywgewogICAgICAgICAgICBob3VzZUlkOiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdob3VzZUlkJyksCiAgICAgICAgICAgIG5hbWU6IHRoaXMuZm9ybS5uYW1lLAogICAgICAgICAgICBwYXNzd29yZDogdGhpcy5mb3JtLnBhc3N3b3JkLAogICAgICAgICAgICBpc0FkbWluOiAwLAogICAgICAgICAgfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZQogICAgICAgICAgICBpZiAocmVzLmRlc2NyaXB0aW9uID09PSAnc3VjY2VzcycpIHsKICAgICAgICAgICAgICB0aGlzLnBhZ2VOdW0gPSAxCiAgICAgICAgICAgICAgdGhpcy5nZXRMaXN0KCkKICAgICAgICAgICAgfQogICAgICAgICAgfSkKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIGZhbHNlCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIGRlbGV0ZVJvdyhyb3cpIHsKICAgICAgcHV0KCcvdXNlci9yZW1vdmUnLCB7CiAgICAgICAgYWRtaW5Vc2VySWQ6IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3VzZXJJZCcpLAogICAgICAgIHJlbW92ZVVzZXJJZDogcm93LmlkLAogICAgICB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICBpZiAocmVzLmRlc2NyaXB0aW9uID09PSAnc3VjY2VzcycpIHsKICAgICAgICAgIE1lc3NhZ2Uuc3VjY2Vzcyh7IG1lc3NhZ2U6ICdTdWNjZXNzZnVsbHkgUmVtb3ZlIScgfSkKICAgICAgICAgIHRoaXMucGFnZU51bSA9IDEKICAgICAgICAgIHRoaXMuZ2V0TGlzdCgpCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICAgIHJlc2V0UGFzc1dvcmQocm93KSB7CiAgICAgIHB1dCgnL3VzZXIvcmVzZXRQd2QnLCB7IGlkOiByb3cuaWQgfSkudGhlbigocmVzKSA9PiB7CiAgICAgICAgaWYgKHJlcy5kZXNjcmlwdGlvbiA9PT0gJ3N1Y2Nlc3MnKSB7CiAgICAgICAgICB0aGlzLnJlc2V0UGFzc3dvcmQgPSBgJHtyb3cubmFtZX0gUGFzc3dvcmQgaGFzIGJlZW4gcmVzZXQgdG86ICR7cmVzLmRhdGEucGFzc3dvcmR9YAogICAgICAgICAgdGhpcy5wYXNzd29yZE1vZGFsVmlzaWJsZSA9IHRydWUKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgdHJhbnNmZXJBZG1pbihyb3cpIHsKICAgICAgcHV0KCcvdXNlci90cmFuc2ZlckFkbWluJywgewogICAgICAgIGZyb21Vc2VySWQ6IHNlc3Npb25TdG9yYWdlLmdldEl0ZW0oJ3VzZXJJZCcpLAogICAgICAgIHRvVXNlcklkOiByb3cuaWQsCiAgICAgIH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgIGlmIChyZXMuZGVzY3JpcHRpb24gPT09ICdzdWNjZXNzJykgewogICAgICAgICAgTWVzc2FnZS5zdWNjZXNzKHsgbWVzc2FnZTogJ1N1Y2Nlc3NmdWxseSBUcmFuc2ZlcicgfSkKICAgICAgICAgIHRoaXMucGFnZU51bSA9IDEKICAgICAgICAgIHRoaXMuZ2V0TGlzdCgpCiAgICAgICAgfQogICAgICB9KQogICAgfSwKICB9LAp9Cg=="},{"version":3,"sources":["UserManage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2GA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"UserManage.vue","sourceRoot":"src/components/UserManage","sourcesContent":["<template>\n  <div class=\"user-manage\" style=\"height: 100%\">\n    <div class=\"user-manage-top\">\n      <!-- <el-input style=\"width: 200px; margin-right: 20px\"\n                placeholder=\"Please Enter The Content\"\n                v-model=\"input2\">\n        <el-button slot=\"append\"\n                   icon=\"el-icon-search\"></el-button>\n      </el-input> -->\n      <el-button type=\"primary\" @click=\"dialogFormVisible = true\"\n        >Add User</el-button\n      >\n      <el-dialog\n        title=\"Add family member\"\n        :visible.sync=\"dialogFormVisible\"\n        destroy-on-close\n      >\n        <el-form :model=\"form\" :rules=\"rules\" ref=\"form\">\n          <el-form-item label=\"Account Number\" :label-width=\"formLabelWidth\" prop=\"name\">\n            <el-input v-model=\"form.name\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n          <el-form-item\n            label=\"Password\"\n            :label-width=\"formLabelWidth\"\n            prop=\"password\"\n          >\n            <el-input v-model=\"form.password\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"dialogFormVisible = false\">Cancel</el-button>\n          <el-button type=\"primary\" @click=\"addUser('form')\">Confirm</el-button>\n        </div>\n      </el-dialog>\n      <el-dialog :visible.sync=\"passwordModalVisible\" destroy-on-close>\n        <div style=\"text-align: center\">{{ resetPassword }}</div>\n      </el-dialog>\n    </div>\n    <div style=\"height: calc(100% - 80px)\" v-loading=\"loading\">\n      <!-- <div slot=\"empty\" style=\"height: 100%; display: flex; justify-content: center; align-items: center\">There is currently no data available</div> -->\n\n      <el-table\n        class=\"user-manage-table\"\n        :data=\"tableData\"\n        style=\"width: 100%\"\n        :row-class-name=\"tableRowClassName\"\n      >\n        <el-table-column prop=\"index\" label=\"Order Number\" type=\"index\" width=\"180\">\n        </el-table-column>\n        <el-table-column prop=\"name\" label=\"Name\" width=\"180\">\n        </el-table-column>\n        <el-table-column\n          prop=\"createTime\"\n          :formatter=\"formatterTime\"\n          label=\"Creation Time\"\n        >\n        </el-table-column>\n        <el-table-column label=\"Operation\" width=\"200\">\n          <template slot-scope=\"scope\">\n            <el-popconfirm\n              :title=\"`Are you sure to move${scope.row.name}out of this family?`\"\n              @confirm=\"deleteRow(scope.row)\"\n            >\n              <el-button type=\"text\" size=\"small\" slot=\"reference\"\n                >Delete</el-button\n              >\n            </el-popconfirm>\n            <el-popconfirm\n              :title=\"`Are you sure you want to reset the password for${scope.row.name}?`\"\n              @confirm=\"resetPassWord(scope.row)\"\n            >\n              <el-button\n                type=\"text\"\n                size=\"small\"\n                slot=\"reference\"\n                style=\"margin: 0 10px\"\n                >Reset Password</el-button\n              >\n            </el-popconfirm>\n            <el-popconfirm\n              :title=\"`Are you sure you want to transfer the administrator to${scope.row.name}?`\"\n              @confirm=\"transferAdmin(scope.row)\"\n            >\n              <el-button type=\"text\" size=\"small\" slot=\"reference\"\n                >Transfer Administrator</el-button\n              >\n            </el-popconfirm>\n          </template>\n        </el-table-column>\n      </el-table>\n      <div style=\"text-align: right; padding: 10px 0 10px 10px\">\n        <el-pagination\n          style=\"padding: 0\"\n          background\n          layout=\"prev, pager, next\"\n          :current-page=\"pageNum\"\n          :total=\"total\"\n          :page-size=\"pageSize\"\n          @current-change=\"handleCurrentChange\"\n        >\n        </el-pagination>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { get, post, put } from '../../utils/http'\nimport moment from 'moment'\nimport { Message } from 'element-ui'\nexport default {\n  name: 'UserManage',\n  mounted() {\n    this.getList()\n  },\n  data() {\n    let validateName = (rule, value, callback) => {\n      console.log(value)\n      if (value === '') {\n        callback(new Error('Please enter your account number'))\n      } else {\n        let reg = /^[a-zA-Z0-9_-]{2,16}$/\n        if (!reg.test(value)) {\n          callback(new Error('The username must consist of 2-16 characters, letters, numbers, and underscores!'))\n        }\n\n        callback()\n      }\n    }\n    let validatePassword = (rule, value, callback) => {\n      if (value === '') {\n        callback(new Error('Please enter password'))\n      } else {\n        let reg = /^[a-zA-Z0-9]{8}$/\n        if (!reg.test(value)) {\n          callback(new Error('The password must consist of 8 letters and numbers, and cannot contain illegal characters!'))\n        }\n\n        callback()\n      }\n    }\n    return {\n      tableData: [],\n      loading: false,\n      dialogFormVisible: false,\n      passwordModalVisible: false,\n      form: {\n        name: '',\n        password: '',\n      },\n      formLabelWidth: '160px',\n      pageNum: 1,\n      pageSize: 10,\n      total: 0,\n      resetPassword: '',\n      rules: {\n        name: [\n          { required: true, message: 'Account cannot be empty', trigger: 'change' },\n          { validator: validateName, trigger: 'change' },\n        ],\n        password: [\n          { required: true, message: 'Password cannot be empty' },\n          { validator: validatePassword, trigger: 'change' },\n        ],\n      },\n    }\n  },\n  methods: {\n    formatterTime(row, column, cellValue) {\n      return moment(cellValue).format('YYYY-MM-DD HH:mm:ss')\n    },\n    tableRowClassName({ rowIndex }) {\n      if (rowIndex === 1) {\n        return 'warning-row'\n      } else if (rowIndex === 3) {\n        return 'success-row'\n      }\n      return ''\n    },\n    handleCurrentChange(val) {\n      this.pageNum = val\n      this.getList()\n    },\n    getList() {\n      this.loading = true\n      get('/user/query', {\n        houseId: sessionStorage.getItem('houseId'),\n        pageNum: this.pageNum,\n        pageSize: this.pageSize,\n      }).then((res) => {\n        this.loading = false\n        if (res.description === 'success') {\n          this.tableData = res.data.list.filter((item) => item.isAdmin !== 1)\n          this.total = res.data.total\n        }\n      })\n    },\n    addUser(formName) {\n      this.$refs[formName].validate((valid) => {\n        if (valid) {\n          post('/user/add', {\n            houseId: sessionStorage.getItem('houseId'),\n            name: this.form.name,\n            password: this.form.password,\n            isAdmin: 0,\n          }).then((res) => {\n            this.dialogFormVisible = false\n            if (res.description === 'success') {\n              this.pageNum = 1\n              this.getList()\n            }\n          })\n        } else {\n          return false\n        }\n      })\n    },\n    deleteRow(row) {\n      put('/user/remove', {\n        adminUserId: sessionStorage.getItem('userId'),\n        removeUserId: row.id,\n      }).then((res) => {\n        if (res.description === 'success') {\n          Message.success({ message: 'Successfully Remove!' })\n          this.pageNum = 1\n          this.getList()\n        }\n      })\n    },\n    resetPassWord(row) {\n      put('/user/resetPwd', { id: row.id }).then((res) => {\n        if (res.description === 'success') {\n          this.resetPassword = `${row.name} Password has been reset to: ${res.data.password}`\n          this.passwordModalVisible = true\n        }\n      })\n    },\n    transferAdmin(row) {\n      put('/user/transferAdmin', {\n        fromUserId: sessionStorage.getItem('userId'),\n        toUserId: row.id,\n      }).then((res) => {\n        if (res.description === 'success') {\n          Message.success({ message: 'Successfully Transfer' })\n          this.pageNum = 1\n          this.getList()\n        }\n      })\n    },\n  },\n}\n</script>\n\n<style>\n.user-manage-top {\n  display: flex;\n  justify-content: flex-end;\n  padding-bottom: 15px;\n}\n.el-table .warning-row {\n  background: oldlace;\n}\n\n.el-table .success-row {\n  background: #f0f9eb;\n}\n.user-manage-table {\n  border: 1px solid #ebebeb;\n}\n</style>\n"]}]}