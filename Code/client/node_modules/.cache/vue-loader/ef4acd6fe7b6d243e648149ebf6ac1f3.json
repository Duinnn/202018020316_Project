{"remainingRequest":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\src\\components\\ConsumeManage\\ConsumeManage.vue?vue&type=script&lang=js&","dependencies":[{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\src\\components\\ConsumeManage\\ConsumeManage.vue","mtime":1711191102586},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709809049101},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\babel-loader\\lib\\index.js","mtime":1709809049077},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1709809049101},{"path":"C:\\Users\\12035\\Desktop\\Graduation Design Code\\client\\node_modules\\vue-loader\\lib\\index.js","mtime":1709809064695}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCB7IGdldCwgcHV0LCBwb3N0IH0gZnJvbSAnLi4vLi4vdXRpbHMvaHR0cCcKaW1wb3J0IG1vbWVudCBmcm9tICdtb21lbnQnCmltcG9ydCB7IE1lc3NhZ2UgfSBmcm9tICdlbGVtZW50LXVpJwoKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdDb25zdW1lTWFuYWdlJywKICBtb3VudGVkKCkgewogICAgdGhpcy5nZXRMaXN0KCkKICB9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICBkaWFsb2dGb3JtVmlzaWJsZTogZmFsc2UsCiAgICAgIHJ1bGVzOiB7CiAgICAgICAgbmFtZTogWwogICAgICAgICAgewogICAgICAgICAgICByZXF1aXJlZDogdHJ1ZSwKICAgICAgICAgICAgbWVzc2FnZTogJ1RoZSBjb25zdW1wdGlvbiB0eXBlIG5hbWUgY2Fubm90IGJlIGVtcHR5JywKICAgICAgICAgICAgdHJpZ2dlcjogJ2NoYW5nZScsCiAgICAgICAgICB9LAogICAgICAgIF0sCiAgICAgIH0sCiAgICAgIGZvcm06IHsKICAgICAgICBuYW1lOiAnJywKICAgICAgfSwKICAgICAgZm9ybUxhYmVsV2lkdGg6ICcxODBweCcsCiAgICAgIGxvYWRpbmc6IGZhbHNlLAogICAgICBwYXJhbXM6IHsKICAgICAgICBob3VzZUlkOiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdob3VzZUlkJyksCiAgICAgIH0sCiAgICAgIHRhYmxlRGF0YTogW10sCiAgICAgIG1vZGFsVGl0bGU6ICdBZGQgbmV3IGNvbnN1bXB0aW9uIHR5cGUnLAogICAgICBzZWxlY3RlZDogJycsCiAgICB9CiAgfSwKICBtZXRob2RzOiB7CiAgICBmb3JtYXR0ZXJUaW1lKHJvdywgY29sdW1uLCBjZWxsVmFsdWUpIHsKICAgICAgcmV0dXJuIG1vbWVudChjZWxsVmFsdWUpLmZvcm1hdCgnWVlZWS1NTS1ERCBISDptbTpzcycpCiAgICB9LAogICAgdGFibGVSb3dDbGFzc05hbWUoeyByb3dJbmRleCB9KSB7CiAgICAgIGlmIChyb3dJbmRleCA9PT0gMSkgewogICAgICAgIHJldHVybiAnd2FybmluZy1yb3cnCiAgICAgIH0gZWxzZSBpZiAocm93SW5kZXggPT09IDMpIHsKICAgICAgICByZXR1cm4gJ3N1Y2Nlc3Mtcm93JwogICAgICB9CiAgICAgIHJldHVybiAnJwogICAgfSwKICAgIGdldExpc3QoKSB7CiAgICAgIHRoaXMubG9hZGluZyA9IHRydWUKICAgICAgZ2V0KCcvY29uc3VtcHRpb25UeXBlL3F1ZXJ5JywgewogICAgICAgIC4uLnRoaXMucGFyYW1zLAogICAgICB9KS50aGVuKChyZXMpID0+IHsKICAgICAgICB0aGlzLmxvYWRpbmcgPSBmYWxzZQogICAgICAgIGlmIChyZXMuZGVzY3JpcHRpb24gPT09ICdzdWNjZXNzJykgewogICAgICAgICAgdGhpcy50YWJsZURhdGEgPSByZXMuZGF0YQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBhZGRDb25zdW1lKGZvcm0pIHsKICAgICAgdGhpcy4kcmVmc1tmb3JtXS52YWxpZGF0ZSgodmFsaWQpID0+IHsKICAgICAgICBpZiAodmFsaWQpIHsKICAgICAgICAgIGxldCBwYXJhbXMgPSB7CiAgICAgICAgICAgIG5hbWU6IHRoaXMuZm9ybS5uYW1lLAogICAgICAgICAgICBob3VzZUlkOiBzZXNzaW9uU3RvcmFnZS5nZXRJdGVtKCdob3VzZUlkJyksCiAgICAgICAgICB9CiAgICAgICAgICBpZiAodGhpcy5tb2RhbFRpdGxlID09PSAnRWRpdCBDb25zdW1wdGlvbiBUeXBlJykgewogICAgICAgICAgICBwYXJhbXMuaWQgPSB0aGlzLnNlbGVjdGVkCiAgICAgICAgICAgIHBhcmFtcy5uZXdOYW1lID0gdGhpcy5mb3JtLm5hbWUKICAgICAgICAgICAgZGVsZXRlIHBhcmFtcy5uYW1lCiAgICAgICAgICAgIHB1dCgnL2NvbnN1bXB0aW9uVHlwZS91cGRhdGVOYW1lJywgcGFyYW1zKS50aGVuKChyZXMpID0+IHsKICAgICAgICAgICAgICBpZiAocmVzLmRlc2NyaXB0aW9uID09PSAnc3VjY2VzcycpIHsKICAgICAgICAgICAgICAgIE1lc3NhZ2Uuc3VjY2Vzcyh7IG1lc3NhZ2U6ICdTdWNjZXNzZnVsbHkgZWRpdGVkIGNvbnN1bXB0aW9uIHR5cGUnIH0pCiAgICAgICAgICAgICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gZmFsc2UKICAgICAgICAgICAgICAgIHRoaXMuZ2V0TGlzdCgpCiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9KQogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgcG9zdCgnL2NvbnN1bXB0aW9uVHlwZS9hZGQnLCBwYXJhbXMpLnRoZW4oKHJlcykgPT4gewogICAgICAgICAgICAgIGlmIChyZXMuZGVzY3JpcHRpb24gPT09ICdzdWNjZXNzJykgewogICAgICAgICAgICAgICAgTWVzc2FnZS5zdWNjZXNzKHsgbWVzc2FnZTogJ1N1Y2Nlc3NmdWxseSBhZGRlZCBuZXcgY29uc3VtcHRpb24gdHlwZScgfSkKICAgICAgICAgICAgICAgIHRoaXMuZGlhbG9nRm9ybVZpc2libGUgPSBmYWxzZQogICAgICAgICAgICAgICAgdGhpcy5nZXRMaXN0KCkKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0pCiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldHVybiBmYWxzZQogICAgICAgIH0KICAgICAgfSkKICAgIH0sCiAgICBkZWxldGVSb3cocm93KSB7CiAgICAgIHB1dCgnL2NvbnN1bXB0aW9uVHlwZS9kZWxldGVUeXBlJywgeyBpZDogcm93LmlkIH0pLnRoZW4oKHJlcykgPT4gewogICAgICAgIGlmIChyZXMuZGVzY3JpcHRpb24gPT09ICdzdWNjZXNzJykgewogICAgICAgICAgTWVzc2FnZS5zdWNjZXNzKHsgbWVzc2FnZTogJ1N1Y2Nlc3NmdWxseSBkZWxldGVkIGNvbnN1bXB0aW9uIHR5cGUnIH0pCgogICAgICAgICAgdGhpcy5nZXRMaXN0KCkKICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgZWRpdENvbnN1bXB0aW9uKHJvdykgewogICAgICB0aGlzLm1vZGFsVGl0bGUgPSAnRWRpdCBDb25zdW1wdGlvbiBUeXBlJwogICAgICB0aGlzLmRpYWxvZ0Zvcm1WaXNpYmxlID0gdHJ1ZQogICAgICB0aGlzLmZvcm0ubmFtZSA9IHJvdy5uYW1lCiAgICAgIHRoaXMuc2VsZWN0ZWQgPSByb3cuaWQKICAgIH0sCiAgfSwKfQo="},{"version":3,"sources":["ConsumeManage.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA2EA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"ConsumeManage.vue","sourceRoot":"src/components/ConsumeManage","sourcesContent":["<template>\n  <div class=\"consume-manage\">\n    <div class=\"consume-manage-top\">\n      <el-button type=\"primary\" @click=\"dialogFormVisible = true\"\n        >Add new consumption type</el-button\n      >\n      <el-dialog\n        title=\"Add new consumption type\"\n        :visible.sync=\"dialogFormVisible\"\n        destroy-on-close\n      >\n        <el-form :model=\"form\" :rules=\"rules\" ref=\"form\">\n          <el-form-item\n            label=\"Consumption Type Name\"\n            :label-width=\"formLabelWidth\"\n            prop=\"name\"\n          >\n            <el-input v-model=\"form.name\" autocomplete=\"off\"></el-input>\n          </el-form-item>\n        </el-form>\n        <div slot=\"footer\" class=\"dialog-footer\">\n          <el-button @click=\"dialogFormVisible = false\">Cancel</el-button>\n          <el-button type=\"primary\" @click=\"addConsume('form')\"\n            >Confirm</el-button\n          >\n        </div>\n      </el-dialog>\n    </div>\n    <div class=\"consume-manage-content\" v-loading=\"loading\">\n      <el-table\n        class=\"user-manage-table\"\n        :data=\"tableData\"\n        style=\"width: 100%\"\n        :row-class-name=\"tableRowClassName\"\n      >\n        <el-table-column prop=\"index\" label=\"Order Number\" type=\"index\" width=\"180\">\n        </el-table-column>\n        <el-table-column prop=\"name\" label=\"Type Name\" width=\"180\">\n        </el-table-column>\n        <el-table-column\n          prop=\"createTime\"\n          :formatter=\"formatterTime\"\n          label=\"Creation Time\"\n        >\n        </el-table-column>\n        <el-table-column label=\"Operation\" width=\"200\">\n          <template slot-scope=\"scope\">\n            <el-button\n              type=\"text\"\n              size=\"small\"\n              slot=\"reference\"\n              @click=\"editConsumption(scope.row)\"\n              >Edit</el-button\n            >\n            <el-popconfirm\n              v-if=\"scope.row.isCustom !== 0\"\n              :title=\"`Are you sure to delete${scope.row.name}type?`\"\n              @confirm=\"deleteRow(scope.row)\"\n            >\n              <el-button\n                type=\"text\"\n                size=\"small\"\n                slot=\"reference\"\n                style=\"margin-left:20px\"\n                >Delete</el-button\n              >\n            </el-popconfirm>\n          </template>\n        </el-table-column>\n      </el-table>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { get, put, post } from '../../utils/http'\nimport moment from 'moment'\nimport { Message } from 'element-ui'\n\nexport default {\n  name: 'ConsumeManage',\n  mounted() {\n    this.getList()\n  },\n  data() {\n    return {\n      dialogFormVisible: false,\n      rules: {\n        name: [\n          {\n            required: true,\n            message: 'The consumption type name cannot be empty',\n            trigger: 'change',\n          },\n        ],\n      },\n      form: {\n        name: '',\n      },\n      formLabelWidth: '180px',\n      loading: false,\n      params: {\n        houseId: sessionStorage.getItem('houseId'),\n      },\n      tableData: [],\n      modalTitle: 'Add new consumption type',\n      selected: '',\n    }\n  },\n  methods: {\n    formatterTime(row, column, cellValue) {\n      return moment(cellValue).format('YYYY-MM-DD HH:mm:ss')\n    },\n    tableRowClassName({ rowIndex }) {\n      if (rowIndex === 1) {\n        return 'warning-row'\n      } else if (rowIndex === 3) {\n        return 'success-row'\n      }\n      return ''\n    },\n    getList() {\n      this.loading = true\n      get('/consumptionType/query', {\n        ...this.params,\n      }).then((res) => {\n        this.loading = false\n        if (res.description === 'success') {\n          this.tableData = res.data\n        }\n      })\n    },\n    addConsume(form) {\n      this.$refs[form].validate((valid) => {\n        if (valid) {\n          let params = {\n            name: this.form.name,\n            houseId: sessionStorage.getItem('houseId'),\n          }\n          if (this.modalTitle === 'Edit Consumption Type') {\n            params.id = this.selected\n            params.newName = this.form.name\n            delete params.name\n            put('/consumptionType/updateName', params).then((res) => {\n              if (res.description === 'success') {\n                Message.success({ message: 'Successfully edited consumption type' })\n                this.dialogFormVisible = false\n                this.getList()\n              }\n            })\n          } else {\n            post('/consumptionType/add', params).then((res) => {\n              if (res.description === 'success') {\n                Message.success({ message: 'Successfully added new consumption type' })\n                this.dialogFormVisible = false\n                this.getList()\n              }\n            })\n          }\n        } else {\n          return false\n        }\n      })\n    },\n    deleteRow(row) {\n      put('/consumptionType/deleteType', { id: row.id }).then((res) => {\n        if (res.description === 'success') {\n          Message.success({ message: 'Successfully deleted consumption type' })\n\n          this.getList()\n        }\n      })\n    },\n    editConsumption(row) {\n      this.modalTitle = 'Edit Consumption Type'\n      this.dialogFormVisible = true\n      this.form.name = row.name\n      this.selected = row.id\n    },\n  },\n}\n</script>\n\n<style>\n.consume-manage {\n  height: calc(100% - 30px);\n}\n.consume-manage-top {\n  display: flex;\n  justify-content: flex-end;\n  padding-bottom: 15px;\n}\n.consume-manage-content {\n  height: calc(100% - 55px);\n}\n</style>\n"]}]}